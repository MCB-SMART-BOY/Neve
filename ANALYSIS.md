# Neve 项目分析 & 发展优先级

> Neve 继承 Nix 的核心理念，同时从零构建全新的技术栈。
>
> Neve inherits the core ideas from Nix while building a completely new technology stack from scratch.

---

## 一、Neve 的定位 / Positioning

### 不是替代，是超越 / Not a Replacement, but Transcendence

Neve **不是** Nix 的替代品或兼容层。Neve 是：

- **继承**: Nix 的纯函数式包管理理念
- **超越**: 用现代语言设计重新实现
- **独立**: 完全独立的生态系统，不依赖 nixpkgs

```
Nix 的理念                    Neve 的实现
    │                              │
    v                              v
┌─────────────────┐         ┌─────────────────┐
│ 纯函数式        │    →    │ 纯函数式        │
│ 可复现构建      │    →    │ 可复现构建      │
│ 声明式配置      │    →    │ 声明式配置      │
│ 内容寻址存储    │    →    │ 内容寻址存储    │
└─────────────────┘         └─────────────────┘
        │                          │
        v                          v
┌─────────────────┐         ┌─────────────────┐
│ 动态类型        │    ✗    │ 静态类型推导    │ ← 超越
│ 语法歧义        │    ✗    │ 零歧义语法      │ ← 超越
│ 历史包袱        │    ✗    │ 现代设计        │ ← 超越
│ nixpkgs 生态    │    ✗    │ 独立生态        │ ← 独立
└─────────────────┘         └─────────────────┘
```

### 为什么要完全独立？

1. **设计自由**: 不受 Nix 语法限制
2. **干净架构**: 不需要兼容层的复杂性
3. **长期愿景**: 构建 Neve OS，需要从底层控制
4. **技术债务**: 不继承 Nix 的历史包袱

---

## 二、Neve 相对 Nix 的优势 / Advantages over Nix

### 语言层面

| 方面 | Nix | Neve |
|------|-----|------|
| 类型系统 | 动态 | 静态 (Hindley-Milner) |
| 语法歧义 | `{ }` 多义 | `#{ }` 记录，`{ }` 代码块 |
| 闭包语法 | `x: x + 1` | `fn(x) x + 1` |
| 错误信息 | 一般 | 精确位置 + 修复建议 |
| Trait | 无 | 完整支持 |
| 模式匹配 | 基本 | 完整（守卫、Or、解构） |

### 工具链

| 工具 | Neve 状态 |
|------|-----------|
| 类型检查器 | ✅ 完整 |
| LSP | ✅ 语义高亮、符号 |
| 格式化器 | ✅ 完整 |
| REPL | ✅ 完整 |
| 沙箱构建 | ✅ Linux 命名空间 |

### 现代语法特性

```neve
-- 管道操作符
data |> parse |> validate |> transform

-- 安全访问
user?.profile?.name ?? "anonymous"

-- 错误传播
let data = fetch(url)?;

-- 字符串插值
`Hello, {name}!`

-- 列表推导
[x * 2 | x <- xs, x > 0]
```

---

## 三、需要构建的独立生态 / Independent Ecosystem to Build

### Bootstrap 路线图

```
Stage 0: 最小工具集 (宿主系统编译)
├── musl (C 标准库)
├── tcc (Tiny C Compiler)
└── busybox (基础工具)

Stage 1: 完整工具链 (用 Stage 0 编译)
├── gcc
├── binutils
├── make
└── bash

Stage 2: Neve 自举 (用 Stage 1 编译)
├── rust
└── neve (自编译)

Stage 3: 核心包集
├── 开发工具 (git, vim, tmux)
├── 网络工具 (curl, openssh)
├── 系统服务 (systemd 或自定义 init)
└── 用户应用
```

### 包生态建设原则

1. **从零开始**: 所有包定义用 Neve 编写
2. **最小依赖**: 每个包依赖尽可能少
3. **可复现**: 所有构建 100% 可复现
4. **自包含**: 不依赖任何外部包管理器

---

## 四、项目发展优先级 / Development Priorities

### Phase 1: 语言完善 (当前)

| 优先级 | 任务 | 状态 |
|--------|------|------|
| P0 | 模块加载器完善 | 🔄 进行中 |
| P0 | 关联类型 | 🔄 进行中 |
| P1 | 尾调用优化 | ⏳ 待开始 |
| P1 | LSP 增强 | 🔄 进行中 |

### Phase 2: Bootstrap (接下来)

| 优先级 | 任务 | 依赖 |
|--------|------|------|
| P0 | 定义 Stage 0 包 | 语言完善 |
| P0 | 实现包构建流程 | Stage 0 |
| P1 | 二进制缓存 | Stage 0 |

### Phase 3: 生态建设

| 优先级 | 任务 | 目标 |
|--------|------|------|
| P0 | 50+ 核心包 | 日常开发可用 |
| P0 | 官方文档站 | neve.dev |
| P1 | 测试框架 | 质量保证 |

### Phase 4: Neve OS

| 优先级 | 任务 | 里程碑 |
|--------|------|--------|
| P0 | 系统配置生成 | 可配置 |
| P0 | Init 系统 | 可启动 |
| P1 | 桌面环境 | 可用 |

---

## 五、近期目标 / Near-term Goals

### 本周
- [ ] 创建 `docs/` 目录
- [ ] 编写 5 分钟入门文档
- [ ] 添加示例代码

### 本月
- [ ] 完善模块加载器
- [ ] LSP 跳转定义
- [ ] 定义第一个 Stage 0 包

### 本季度
- [ ] Stage 0 完成
- [ ] 语言参考文档
- [ ] 10+ 核心包定义

---

## 六、成功路径 / Path to Success

```
现在                3个月               6个月              12个月
 │                    │                   │                  │
 v                    v                   v                  v
语言核心 95%  →   语言 100%    →    Bootstrap   →    Neve OS
                  入门文档            自编译            可启动
                  Stage 0            50+ 包            独立生态
```

### 核心原则

1. **独立优先**: 不寻求 Nix 兼容
2. **质量优先**: 宁可功能少，也要稳定
3. **文档优先**: 好文档胜过更多功能
4. **社区建设**: 寻找志同道合的贡献者

---

*最后更新: 2025-12-28*
